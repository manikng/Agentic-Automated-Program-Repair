prefix_lengths = [j for j in range(1, longest + 1) if arr[ends[j]] < val]